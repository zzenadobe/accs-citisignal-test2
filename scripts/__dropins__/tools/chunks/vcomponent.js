/*! Copyright 2025 Adobe
All Rights Reserved. */
var me=Object.defineProperty;var be=(e,t,r)=>t in e?me(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var re=(e,t,r)=>be(e,typeof t!="symbol"?t+"":t,r);import{g as xe}from"./image-params-keymap.js";import{jsx as $}from"../preact-jsx-runtime.js";import{l as g,_ as pe,k as T,G as we,B as ne}from"./icons/Add.js";import{signal as ie}from"../signals.js";const Oe=e=>e.reduce((r,i)=>{if(!i)return r;if(typeof i=="string"&&(r+=` ${i}`),Array.isArray(i)){const[u,_]=i;u&&_&&(r+=` ${u}`)}return r},"").trim(),se={medium:768,large:1024,xlarge:1366,xxlarge:1920},je=(e,t)=>{const[r,i]=e.split("?"),u=new URLSearchParams(i),_=xe(),v=_&&Object.keys(_)||[];let c={},m={..._};return(v==null?void 0:v.length)>0&&t?c=Object.entries(t).reduce((p,[y,o])=>{const a=_[y];if(typeof a=="string")p[a]=o;else if(typeof a=="function"){const[w,x]=a(o);p[w]=x}return delete m[y],p},{}):c={auto:"webp",quality:80,crop:!1,fit:"cover",...t},Object.entries(m).forEach(([,p])=>{if(typeof p=="function"){const[y,o]=p(void 0);c[y]=o}}),Object.entries(c).forEach(([p,y])=>{y!=null&&u.set(p,String(y))}),`${r}?${u.toString()}`},Te=(e,t)=>{if(!e||!(t!=null&&t.width))return;const r=i=>je(e,{...i});return Object.entries(se).map(([,i])=>{const u=t.width*i/se.xxlarge;return`${r({...t,width:u})} ${i}w`}).join(`,
`)};var Ae=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|^--/i,_e=/^(area|base|br|col|embed|hr|img|input|link|meta|param|source|track|wbr)$/,W=/[\s\n\\/='"\0<>]/,ve=/^xlink:?./,Se=/["&<]/;function E(e){if(Se.test(e+="")===!1)return e;for(var t=0,r=0,i="",u="";r<e.length;r++){switch(e.charCodeAt(r)){case 34:u="&quot;";break;case 38:u="&amp;";break;case 60:u="&lt;";break;default:continue}r!==t&&(i+=e.slice(t,r)),i+=u,t=r+1}return r!==t&&(i+=e.slice(t,r)),i}var ae=function(e,t){return String(e).replace(/(\n+)/g,"$1"+(t||"	"))},oe=function(e,t,r){return String(e).length>40||String(e).indexOf(`
`)!==-1||String(e).indexOf("<")!==-1},le={},$e=/([A-Z])/g;function ge(e){var t="";for(var r in e){var i=e[r];i!=null&&i!==""&&(t&&(t+=" "),t+=r[0]=="-"?r:le[r]||(le[r]=r.replace($e,"-$1").toLowerCase()),t=typeof i=="number"&&Ae.test(r)===!1?t+": "+i+"px;":t+": "+i+";")}return t||void 0}function I(e,t){return Array.isArray(t)?t.reduce(I,e):t!=null&&t!==!1&&e.push(t),e}function fe(){this.__d=!0}function he(e,t){return{__v:e,context:t,props:e.props,setState:fe,forceUpdate:fe,__d:!0,__h:[]}}function K(e,t){var r=e.contextType,i=r&&t[r.__c];return r!=null?i?i.props.value:r.__:t}var Q=[];function F(e,t,r,i,u,_){if(e==null||typeof e=="boolean")return"";if(typeof e!="object")return typeof e=="function"?"":E(e);var v=r.pretty,c=v&&typeof v=="string"?v:"	";if(Array.isArray(e)){for(var m="",p=0;p<e.length;p++)v&&p>0&&(m+=`
`),m+=F(e[p],t,r,i,u,_);return m}if(e.constructor!==void 0)return"";var y,o=e.type,a=e.props,w=!1;if(typeof o=="function"){if(w=!0,!r.shallow||!i&&r.renderRootComponent!==!1){if(o===T){var x=[];return I(x,e.props.children),F(x,t,r,r.shallowHighOrder!==!1,u,_)}var h,n=e.__c=he(e,t);g.__b&&g.__b(e);var M=g.__r;if(o.prototype&&typeof o.prototype.render=="function"){var k=K(o,t);(n=e.__c=new o(a,k)).__v=e,n._dirty=n.__d=!0,n.props=a,n.state==null&&(n.state={}),n._nextState==null&&n.__s==null&&(n._nextState=n.__s=n.state),n.context=k,o.getDerivedStateFromProps?n.state=Object.assign({},n.state,o.getDerivedStateFromProps(n.props,n.state)):n.componentWillMount&&(n.componentWillMount(),n.state=n._nextState!==n.state?n._nextState:n.__s!==n.state?n.__s:n.state),M&&M(e),h=n.render(n.props,n.state,n.context)}else for(var N=K(o,t),P=0;n.__d&&P++<25;)n.__d=!1,M&&M(e),h=o.call(e.__c,a,N);return n.getChildContext&&(t=Object.assign({},t,n.getChildContext())),g.diffed&&g.diffed(e),F(h,t,r,r.shallowHighOrder!==!1,u,_)}o=(y=o).displayName||y!==Function&&y.name||function(X){var J=(Function.prototype.toString.call(X).match(/^\s*function\s+([^( ]+)/)||"")[1];if(!J){for(var z=-1,Y=Q.length;Y--;)if(Q[Y]===X){z=Y;break}z<0&&(z=Q.push(X)-1),J="UnnamedComponent"+z}return J}(y)}var j,O,d="<"+o;if(a){var b=Object.keys(a);r&&r.sortAttributes===!0&&b.sort();for(var C=0;C<b.length;C++){var s=b[C],f=a[s];if(s!=="children"){if(!W.test(s)&&(r&&r.allAttributes||s!=="key"&&s!=="ref"&&s!=="__self"&&s!=="__source")){if(s==="defaultValue")s="value";else if(s==="defaultChecked")s="checked";else if(s==="defaultSelected")s="selected";else if(s==="className"){if(a.class!==void 0)continue;s="class"}else u&&ve.test(s)&&(s=s.toLowerCase().replace(/^xlink:?/,"xlink:"));if(s==="htmlFor"){if(a.for)continue;s="for"}s==="style"&&f&&typeof f=="object"&&(f=ge(f)),s[0]==="a"&&s[1]==="r"&&typeof f=="boolean"&&(f=String(f));var l=r.attributeHook&&r.attributeHook(s,f,t,r,w);if(l||l==="")d+=l;else if(s==="dangerouslySetInnerHTML")O=f&&f.__html;else if(o==="textarea"&&s==="value")j=f;else if((f||f===0||f==="")&&typeof f!="function"){if(!(f!==!0&&f!==""||(f=s,r&&r.xml))){d=d+" "+s;continue}if(s==="value"){if(o==="select"){_=f;continue}o==="option"&&_==f&&a.selected===void 0&&(d+=" selected")}d=d+" "+s+'="'+E(f)+'"'}}}else j=f}}if(v){var A=d.replace(/\n\s*/," ");A===d||~A.indexOf(`
`)?v&&~d.indexOf(`
`)&&(d+=`
`):d=A}if(d+=">",W.test(o))throw new Error(o+" is not a valid HTML tag name in "+d);var D,ye=_e.test(o)||r.voidElements&&r.voidElements.test(o),S=[];if(O)v&&oe(O)&&(O=`
`+c+ae(O,c)),d+=O;else if(j!=null&&I(D=[],j).length){for(var U=v&&~d.indexOf(`
`),ee=!1,Z=0;Z<D.length;Z++){var B=D[Z];if(B!=null&&B!==!1){var L=F(B,t,r,!0,o==="svg"||o!=="foreignObject"&&u,_);if(v&&!U&&oe(L)&&(U=!0),L)if(v){var te=L.length>0&&L[0]!="<";ee&&te?S[S.length-1]+=L:S.push(L),ee=te}else S.push(L)}}if(v&&U)for(var G=S.length;G--;)S[G]=`
`+c+ae(S[G],c)}if(S.length||O)d+=S.join("");else if(r&&r.xml)return d.substring(0,d.length-1)+" />";return!ye||D||O?(v&&~d.indexOf(`
`)&&(d+=`
`),d=d+"</"+o+">"):d=d.replace(/>$/," />"),d}var ke={shallow:!0};V.render=V;var Ce=function(e,t){return V(e,t,ke)},ue=[];function V(e,t,r){t=t||{};var i=g.__s;g.__s=!0;var u,_=pe(T,null);return _.__k=[e],u=r&&(r.pretty||r.voidElements||r.sortAttributes||r.shallow||r.allAttributes||r.xml||r.attributeHook)?F(e,t,r):q(e,t,!1,void 0,_),g.__c&&g.__c(e,ue),g.__s=i,ue.length=0,u}function R(e){return e==null||typeof e=="boolean"?null:typeof e=="string"||typeof e=="number"||typeof e=="bigint"?pe(null,null,e):e}function Ne(e,t){return e==="className"?"class":e==="htmlFor"?"for":e==="defaultValue"?"value":e==="defaultChecked"?"checked":e==="defaultSelected"?"selected":t&&ve.test(e)?e.toLowerCase().replace(/^xlink:?/,"xlink:"):e}function Le(e,t){return e==="style"&&t!=null&&typeof t=="object"?ge(t):e[0]==="a"&&e[1]==="r"&&typeof t=="boolean"?String(t):t}var ce=Array.isArray,de=Object.assign;function q(e,t,r,i,u){if(e==null||e===!0||e===!1||e==="")return"";if(typeof e!="object")return typeof e=="function"?"":E(e);if(ce(e)){var _="";u.__k=e;for(var v=0;v<e.length;v++)_+=q(e[v],t,r,i,u),e[v]=R(e[v]);return _}if(e.constructor!==void 0)return"";e.__=u,g.__b&&g.__b(e);var c=e.type,m=e.props;if(typeof c=="function"){var p;if(c===T)p=m.children;else{p=c.prototype&&typeof c.prototype.render=="function"?function(b,C){var s=b.type,f=K(s,C),l=new s(b.props,f);b.__c=l,l.__v=b,l.__d=!0,l.props=b.props,l.state==null&&(l.state={}),l.__s==null&&(l.__s=l.state),l.context=f,s.getDerivedStateFromProps?l.state=de({},l.state,s.getDerivedStateFromProps(l.props,l.state)):l.componentWillMount&&(l.componentWillMount(),l.state=l.__s!==l.state?l.__s:l.state);var A=g.__r;return A&&A(b),l.render(l.props,l.state,l.context)}(e,t):function(b,C){var s,f=he(b,C),l=K(b.type,C);b.__c=f;for(var A=g.__r,D=0;f.__d&&D++<25;)f.__d=!1,A&&A(b),s=b.type.call(f,b.props,l);return s}(e,t);var y=e.__c;y.getChildContext&&(t=de({},t,y.getChildContext()))}var o=q(p=p!=null&&p.type===T&&p.key==null?p.props.children:p,t,r,i,e);return g.diffed&&g.diffed(e),e.__=void 0,g.unmount&&g.unmount(e),o}var a,w,x="<";if(x+=c,m)for(var h in a=m.children,m){var n=m[h];if(!(h==="key"||h==="ref"||h==="__self"||h==="__source"||h==="children"||h==="className"&&"class"in m||h==="htmlFor"&&"for"in m||W.test(h))){if(n=Le(h=Ne(h,r),n),h==="dangerouslySetInnerHTML")w=n&&n.__html;else if(c==="textarea"&&h==="value")a=n;else if((n||n===0||n==="")&&typeof n!="function"){if(n===!0||n===""){n=h,x=x+" "+h;continue}if(h==="value"){if(c==="select"){i=n;continue}c!=="option"||i!=n||"selected"in m||(x+=" selected")}x=x+" "+h+'="'+E(n)+'"'}}}var M=x;if(x+=">",W.test(c))throw new Error(c+" is not a valid HTML tag name in "+x);var k="",N=!1;if(w)k+=w,N=!0;else if(typeof a=="string")k+=E(a),N=!0;else if(ce(a)){e.__k=a;for(var P=0;P<a.length;P++){var j=a[P];if(a[P]=R(j),j!=null&&j!==!1){var O=q(j,t,c==="svg"||c!=="foreignObject"&&r,i,e);O&&(k+=O,N=!0)}}}else if(a!=null&&a!==!1&&a!==!0){e.__k=[R(a)];var d=q(a,t,c==="svg"||c!=="foreignObject"&&r,i,e);d&&(k+=d,N=!0)}if(g.diffed&&g.diffed(e),e.__=void 0,g.unmount&&g.unmount(e),N)x+=k;else if(_e.test(c))return M+" />";return x+"</"+c+">"}V.shallowRender=Ce;const Me=we(null);class Ve{constructor(t){re(this,"_provider");this._provider=t}render(t,r){return async i=>{var o;if(!t)throw new Error("Component is not defined");if(!i)throw new Error("Root element is not defined");const u=await((o=t.getInitialData)==null?void 0:o.call(t,r))??{},_=ie({...r}),v=ie(new Set),c=this._provider,m=({next:a})=>$(Me.Provider,{value:v,children:$(H,{node:c,...c.props,children:$(t,{...a.value,initialData:u})})});i.innerHTML="";const p=document.createElement("div");i.classList.add("dropin-design"),ne($(m,{next:_}),p);const y={remove:()=>{ne(null,p)},setProps:a=>{const w=a(_.peek());_.value=w}};return new Promise(a=>{v.subscribe(w=>{if(w.size===0)return i.classList.add("dropin-design"),i.appendChild(p.firstChild??p),a(y)})})}}unmount(t){var r;if(!t)throw new Error("Root element is not defined");(r=t.firstChild)==null||r.remove()}async toString(t,r,i){var _;if(!t)throw new Error("Component is not defined");const u=await((_=t.getInitialData)==null?void 0:_.call(t,r))??{};return V($(H,{node:this._provider,...this._provider.props,children:$(t,{...r,initialData:u})}),{},{...i})}}function H({node:e,...t}){return e?Array.isArray(e)?$(T,{children:e.map((r,i)=>$(H,{node:r,className:t.className,...t},i))}):(t.className=Oe([e.props.className,t.className]),$(e.type,{ref:e.ref,...e.props,...t},e.key)):null}export{Ve as R,Me as S,H as V,Oe as c,Te as g};
//# sourceMappingURL=vcomponent.js.map
