/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as m}from"@dropins/tools/preact-jsx-runtime.js";import{useState as c,useCallback as y,useEffect as u}from"@dropins/tools/preact-compat.js";import{Button as C,Icon as d}from"@dropins/tools/components.js";import{events as a}from"@dropins/tools/event-bus.js";import{s as j,g as q,i as x,r as E}from"../chunks/removeProductsFromWishlist.js";import{c as H,a as P}from"../chunks/mergeWishlists.js";import{S as T}from"../chunks/HeartFilled.js";import{S as z}from"../chunks/Heart.js";import"@dropins/tools/fetch-graphql.js";import"@dropins/tools/lib.js";const V=({product:s,iconWishlisted:I,iconToWishlist:v,size:g,variant:k,disabled:D,labelToWishlist:U,labelWishlisted:p,onClick:w,removeProdFromCart:r})=>{const[O,S]=c(j.authenticated),[f,n]=c(!1),[h,W]=c(null),{isGuestWishlistEnabled:L}=H.getConfig(),o=y(()=>{var i;const e=q(),t=(i=e==null?void 0:e.items)==null?void 0:i.find(l=>x(l,{sku:s.topLevelSku??s.sku,optionUIDs:s.optionUIDs??(s.selectedOptionsUIDs?Object.values(s.selectedOptionsUIDs):void 0)}));W(t??null),n(!!t)},[s.topLevelSku,s.sku,s.optionUIDs,s.selectedOptionsUIDs]);u(()=>{o()},[o]),u(()=>{const e=l=>S(l),t=a.on("authenticated",e),i=a.on("wishlist/data",o);return()=>{t==null||t.off(),i==null||i.off()}},[o]);const b=async()=>{var e;f?(await E([h]),n(!1),a.emit("wishlist/alert",{action:"remove",item:h})):(await P([{sku:s.topLevelSku??s.sku,quantity:1,optionsUIDs:s.optionUIDs??(s.selectedOptionsUIDs?Object.values(s.selectedOptionsUIDs):void 0),enteredOptions:(e=s.options)!=null&&e.items?s.options.items.filter(t=>t.selected).map(t=>({uid:t.uid,value:t.value})):void 0}]),n(!0),a.emit("wishlist/alert",{action:"add",item:{product:s}}),r&&await r([{uid:s.uid,quantity:0}]))};return!O&&!L?null:m(C,{active:f,"data-testid":"wishlist-toggle",size:g??"medium",variant:k??"tertiary",disabled:D,icon:m(d,{source:v??z}),activeIcon:m(d,{source:I??T}),onClick:w??b,children:U,activeChildren:p})};export{V as WishlistToggle,V as default};
